name: Frontend | Build | Deployment

pool: Self-Hosted

trigger: none

variables:
  - name: sonar.host.url
    value: 'http://127.0.0.1:9000'

  - name: sonar.token
    value: 'sqp_fa87bc77653bf4144e66a723d02b88085759bf51'

  - name: sonar.projectKey
    value: 'todo-ui-frontend'

  - name: working.directory
    value: '$(System.DefaultWorkingDirectory)/frontend'

resources:
  repositories:
    - repository: githubTemplate
      type: github
      endpoint: anurag-vj
      name: anurag-vj/devops-cicd-workflows-pipeline-library
      ref: refs/heads/main

stages:
  - template: .azure/pipeline/sonarqube.yaml@githubTemplate
    parameters:
      sonarHost: $(sonar.host.url)
      sonarToken: $(sonar.token)
      sonarProject: $(sonar.projectKey)
      workingDirectory: $(working.directory)

  - template: .azure/pipeline/retirejs.yaml@githubTemplate
    parameters:
      jobName: 'RetireJS Scan'
